---
description: threads í¬ë¡¤ëŸ¬ë¥¼ ìˆ˜ì •í•  ë•Œ ì°¸ê³ í•˜ì„¸ìš”
globs:
alwaysApply: false
---
# Threads í¬ë¡¤ëŸ¬ ê°€ì´ë“œ

Metaì˜ Threads í”Œë«í¼ì—ì„œ ê²Œì‹œê¸€ì„ í¬ë¡¤ë§í•˜ëŠ” ì‹œìŠ¤í…œì— ëŒ€í•œ ì¢…í•© ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ êµ¬ì¡°

### í•µì‹¬ íŒŒì¼ë“¤
- [src/crawlers/threads.py](mdc:src/crawlers/threads.py) - Threads ì „ìš© í¬ë¡¤ëŸ¬
- [src/crawlers/base.py](mdc:src/crawlers/base.py) - ëª¨ë“  í¬ë¡¤ëŸ¬ì˜ ë² ì´ìŠ¤ í´ë˜ìŠ¤
- [main.py](mdc:main.py) - CLI ì¸í„°í˜ì´ìŠ¤
- [src/models.py](mdc:src/models.py) - ë°ì´í„° ëª¨ë¸ ì •ì˜

### ì„¤ì • íŒŒì¼ë“¤
- `.env` - í™˜ê²½ ë³€ìˆ˜ (ë¡œê·¸ì¸ ì •ë³´)
- `data/threads_session.json` - ì„¸ì…˜ ìƒíƒœ ì €ì¥

## ğŸŒ Threads ì›¹ì‚¬ì´íŠ¸ êµ¬ì¡°

### URL íŒ¨í„´
```
https://threads.net/ - ë©”ì¸ í”¼ë“œ
https://threads.net/login - ë¡œê·¸ì¸ í˜ì´ì§€
https://www.instagram.com/accounts/login/ - Instagram ë¡œê·¸ì¸ í˜ì´ì§€
https://threads.net/@username/post/POST_ID - ê°œë³„ ê²Œì‹œê¸€
```

### DOM êµ¬ì¡° íŠ¹ì„±
```html
<!-- ë¡œê·¸ì¸ ë²„íŠ¼ -->
<div role="button" tabindex="0">Continue with Instagram</div>

<!-- ê²Œì‹œê¸€ ì»¨í…Œì´ë„ˆ -->
<div class="x78zum5 xdt5ytf">
  <!-- ì‘ì„±ì ë§í¬ -->
  <a href="/@username">username</a>

  <!-- ê²Œì‹œ ì‹œê°„ -->
  <time datetime="2024-01-01T12:00:00.000Z">1h</time>

  <!-- ì½˜í…ì¸  -->
  <span class="xi7mnp6">ê²Œì‹œê¸€ ë‚´ìš©</span>

  <!-- ìƒí˜¸ì‘ìš© ë²„íŠ¼ë“¤ -->
  <svg aria-label="Like">...</svg>
  <svg aria-label="Comment">...</svg>
  <svg aria-label="Repost">...</svg>
</div>

<!-- ë¡œê·¸ì¸ëœ ìƒíƒœ ì§€í‘œ -->
<div role="button">What's new?</div>
<div role="button">Post</div>
```

## ğŸ”„ í¬ë¡¤ë§ í”„ë¡œì„¸ìŠ¤ íë¦„ë„

```mermaid
graph TD
    A[ì‹œì‘] --> B[í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ]
    B --> C[ì„¸ì…˜ íŒŒì¼ í™•ì¸]
    C --> D{ì„¸ì…˜ ì¡´ì¬?}

    D -->|Yes| E[ì„¸ì…˜ ë¡œë“œ ì‹œë„]
    D -->|No| F[ìƒˆ ë¡œê·¸ì¸ í•„ìš”]

    E --> G{ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸}
    G -->|Success| H[í”¼ë“œ í˜ì´ì§€ ì´ë™]
    G -->|Failed| F

    F --> I[ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­]
    I --> J[Instagram í˜ì´ì§€ ì´ë™]
    J --> K[ê³„ì • ì •ë³´ ì…ë ¥]
    K --> L[ë¡œê·¸ì¸ ì²˜ë¦¬]
    L --> M{Save info í™”ë©´?}

    M -->|Yes| N[Save info í´ë¦­]
    M -->|No| O[ë¡œê·¸ì¸ ì™„ë£Œ í™•ì¸]
    N --> P[5ì´ˆ ëŒ€ê¸°]
    P --> O

    O --> Q[ì„¸ì…˜ ì €ì¥]
    Q --> H

    H --> R[ê²Œì‹œê¸€ ì»¨í…Œì´ë„ˆ íƒìƒ‰]
    R --> S[DOM ìš”ì†Œ íŒŒì‹±]
    S --> T[ë°ì´í„° ì¶”ì¶œ]
    T --> U[JSON ì €ì¥]
    U --> V[ì™„ë£Œ]
```

## âš™ï¸ ì£¼ìš” ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜ (.env)
```bash
THREADS_USERNAME=your_instagram_username
THREADS_PASSWORD=your_instagram_password
THREADS_USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64)...
THREADS_DEBUG_MODE=false
THREADS_DEBUG_SCREENSHOT_PATH=./data/debug_screenshots
```

### í¬ë¡¤ëŸ¬ ì„¤ì •
- **User-Agent**: ë°ìŠ¤í¬í†± Chrome (ëª¨ë°”ì¼ UI ë¬¸ì œ ë°©ì§€)
- **í—¤ë“œë¦¬ìŠ¤ ëª¨ë“œ**: í•­ìƒ False (ë¸Œë¼ìš°ì € ì°½ í‘œì‹œ)
- **ì„¸ì…˜ ê´€ë¦¬**: Storage State ê¸°ë°˜
- **íƒ€ì„ì•„ì›ƒ**: ë¡œê·¸ì¸ 30ì´ˆ, í˜ì´ì§€ ë¡œë“œ 15ì´ˆ

## ğŸš¨ ìì£¼ ë°œìƒí•˜ëŠ” ì—ëŸ¬ì™€ í•´ê²°ì±…

### 1. ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
**ì¦ìƒ**: `âŒ ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`

**ì›ì¸**:
- ì˜ëª»ëœ User-Agent (ëª¨ë°”ì¼ vs ë°ìŠ¤í¬í†±)
- ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœ
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë¬¸ì œ

**í•´ê²°ì±…**:
```bash
# ë””ë²„ê·¸ ëª¨ë“œë¡œ ì‹¤í–‰
python main.py threads --debug

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
echo $THREADS_USER_AGENT
```

### 2. ì„¸ì…˜ ë¡œë“œ ì‹¤íŒ¨
**ì¦ìƒ**: `âš ï¸ ì„¸ì…˜ ë¡œë“œ ì¤‘ ì˜¤ë¥˜: SecurityError`

**ì›ì¸**:
- localStorage ì ‘ê·¼ ê¶Œí•œ ë¬¸ì œ
- ì†ìƒëœ ì„¸ì…˜ íŒŒì¼

**í•´ê²°ì±…**:
```bash
# ì„¸ì…˜ íŒŒì¼ ì‚­ì œ í›„ ì¬ë¡œê·¸ì¸
rm data/threads_session.json
python main.py threads --debug
```

### 3. Instagram ë¡œê·¸ì¸ íƒ€ì„ì•„ì›ƒ
**ì¦ìƒ**: `âš ï¸ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ íƒ€ì„ì•„ì›ƒ`

**ì›ì¸**:
- ëŠë¦° ë„¤íŠ¸ì›Œí¬
- 2FA í•„ìš”
- ì˜ëª»ëœ ê³„ì • ì •ë³´

**í•´ê²°ì±…**:
1. íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì¦ê°€ (í™˜ê²½ë³€ìˆ˜)
2. ìˆ˜ë™ ë¡œê·¸ì¸ (ë””ë²„ê·¸ ëª¨ë“œ)
3. ê³„ì • ì •ë³´ í™•ì¸

### 4. ê²Œì‹œê¸€ ì¶”ì¶œ ì‹¤íŒ¨
**ì¦ìƒ**: `ğŸ”— ì‹¤ì œ HTML êµ¬ì¡° ê¸°ë°˜ìœ¼ë¡œ 0ê°œì˜ ê²Œì‹œê¸€ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤`

**ì›ì¸**:
- DOM êµ¬ì¡° ë³€ê²½
- ë¡œê·¸ì¸ ìƒíƒœ ë¶ˆì•ˆì •
- ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ

**í•´ê²°ì±…**:
1. ë¡œê·¸ì¸ ìƒíƒœ ì¬í™•ì¸
2. í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
3. DOM ì„ íƒì ì—…ë°ì´íŠ¸

### 5. "Save info" ì²˜ë¦¬ ë¬¸ì œ
**ì¦ìƒ**: ë¡œê·¸ì¸ í›„ ë¬´í•œ ëŒ€ê¸°

**ì›ì¸**:
- ë²„íŠ¼ í´ë¦­ í›„ ì²˜ë¦¬ ì‹œê°„ ë¶€ì¡±
- ë„¤íŠ¸ì›Œí¬ ë¶ˆì•ˆì •

**í•´ê²°ì±…**:
- ëŒ€ê¸° ì‹œê°„ ì¦ê°€ (í˜„ì¬ 5ì´ˆ)
- ë„¤íŠ¸ì›Œí¬ ì•ˆì •í™” ëŒ€ê¸° ì¶”ê°€

## ğŸ› ë””ë²„ê·¸ ëª¨ë“œ í™œìš©

### ê¸°ë³¸ ì‚¬ìš©ë²•
```bash
python main.py threads --count 5 --debug
```

### ë””ë²„ê·¸ ê¸°ëŠ¥ë“¤
1. **ë¸Œë¼ìš°ì € í‘œì‹œ**: headless=false
2. **ê°œë°œì ë„êµ¬**: ìë™ ì—´ë¦¼
3. **ìŠ¤í¬ë¦°ìƒ·**: ê° ë‹¨ê³„ë³„ ìë™ ì €ì¥
4. **ìš”ì†Œ ë¶„ì„**: í˜ì´ì§€ì˜ ëª¨ë“  ë²„íŠ¼ ì •ë³´ ì¶œë ¥
5. **ìˆ˜ë™ ëŒ€ê¸°**: ì‚¬ìš©ì ì…ë ¥ìœ¼ë¡œ ë‹¨ê³„ë³„ í™•ì¸

### ìŠ¤í¬ë¦°ìƒ· íŒŒì¼ëª… íŒ¨í„´
```
HHMMSS_00_initial_page.png - ì´ˆê¸° í˜ì´ì§€
HHMMSS_02_before_login_click_attempt_N.png - ë¡œê·¸ì¸ í´ë¦­ ì „
HHMMSS_04_instagram_login_page_attempt_N.png - Instagram í˜ì´ì§€
HHMMSS_08_login_success_attempt_N.png - ë¡œê·¸ì¸ ì„±ê³µ
```

## ğŸ”§ ì½”ë“œ ìˆ˜ì • ê°€ì´ë“œ

### ìƒˆë¡œìš´ ì„ íƒì ì¶”ê°€
```python
# threads.pyì˜ login_button_selectorsì— ì¶”ê°€
login_button_selectors = [
    'div[role="button"]:has-text("Continue with Instagram")',
    'new_selector_here',  # ìƒˆ ì„ íƒì ì¶”ê°€
]
```

### ê²Œì‹œê¸€ íŒŒì‹± ë¡œì§ ìˆ˜ì •
```python
# _extract_post_data ë©”ì„œë“œì—ì„œ ìƒˆ í•„ë“œ ì¶”ê°€
async def _extract_post_data(self, element) -> Dict[str, Any]:
    # ê¸°ì¡´ í•„ë“œë“¤...
    new_field = await self._extract_new_field(element)
    return {
        "author": author,
        "content": content,
        "new_field": new_field,  # ìƒˆ í•„ë“œ ì¶”ê°€
        # ...
    }
```

### ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 
```python
try:
    # ìœ„í—˜í•œ ì‘ì—…
    result = await some_operation()
except SpecificError as e:
    typer.echo(f"âš ï¸ íŠ¹ì • ì—ëŸ¬ ë°œìƒ: {e}")
    if self.debug_mode:
        await self._debug_screenshot(page, "error_state")
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### í¬ë¡¤ë§ ì†ë„ ê°œì„ 
1. **ìŠ¤í¬ë¡¤ ìµœì í™”**: ë¶ˆí•„ìš”í•œ ìŠ¤í¬ë¡¤ ì œê±°
2. **ì„ íƒì ìš°ì„ ìˆœìœ„**: ìì£¼ ì„±ê³µí•˜ëŠ” ì„ íƒìë¥¼ ì•ì— ë°°ì¹˜
3. **íƒ€ì„ì•„ì›ƒ ì¡°ì •**: í™˜ê²½ì— ë§ëŠ” íƒ€ì„ì•„ì›ƒ ì„¤ì •

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”
1. **ê²Œì‹œê¸€ ìˆ˜ ì œí•œ**: ëŒ€ëŸ‰ í¬ë¡¤ë§ ì‹œ ë°°ì¹˜ ì²˜ë¦¬
2. **ì„¸ì…˜ ì •ë¦¬**: ë¶ˆí•„ìš”í•œ ì„¸ì…˜ ë°ì´í„° ì œê±°
3. **ë¸Œë¼ìš°ì € ë¦¬ì†ŒìŠ¤**: ì ì ˆí•œ ë¸Œë¼ìš°ì € ì˜µì…˜ ì„¤ì •

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ê³„ì • ë³´ì•ˆ
- `.env` íŒŒì¼ì„ `.gitignore`ì— ì¶”ê°€
- ê°•ë ¥í•œ íŒ¨ìŠ¤ì›Œë“œ ì‚¬ìš©
- 2FA ì„¤ì • ê¶Œì¥

### í¬ë¡¤ë§ ìœ¤ë¦¬
- ê³¼ë„í•œ ìš”ì²­ ë°©ì§€ (ì ì ˆí•œ ëŒ€ê¸° ì‹œê°„)
- robots.txt ì¤€ìˆ˜
- ì´ìš© ì•½ê´€ í™•ì¸

## ğŸš€ ì‹¤í–‰ ê°€ì´ë“œ

### ì²« ì‹¤í–‰
```bash
# í™˜ê²½ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ì— ê³„ì • ì •ë³´ ì…ë ¥

# ì²« í¬ë¡¤ë§ (ë””ë²„ê·¸ ëª¨ë“œ ê¶Œì¥)
python main.py threads --count 5 --debug
```

### ì •ê¸° ì‹¤í–‰
```bash
# ì¼ë°˜ ëª¨ë“œ (ë¹ ë¥¸ ì‹¤í–‰)
python main.py threads --count 20

# ì¶œë ¥ íŒŒì¼ ì§€ì •
python main.py threads --count 10 --output my_threads.json
```
